# 1 導入

QUICはUDP上の並列化され、セキュアな新しいトランスポートです。QUICはトランスポートの歴史やセキュリティの経験の上に成り立ち、また汎用的なトランスポートとしてより魅力的になるような機構を実装します。

// TODO: attributesの翻訳検証
QUICはRFCやinternet-draftにて説明され、またlinux  TCP実装において広く流布している既知のTCP損失検知メカニズムの骨子を実装します。この文書はQUIC輻輳制御と損失検知、どのように可用であるかやRFC、internet-draft、学術論文、実装らにおけるTCPとの等価性を示します。

## 1.1 notational conventions

TBD

＃ 2 QUIC転送機構の設計
QUICにおける全ての転送はパケットシークエンスナンバー(以下パケットナンバーとして参照)を含むパケットレベルのヘッダと共に送られます。これらのパケットナンバーはコネクションのライフタイムにおいて重複することはなく、重複の検知をするため単調に増加し続けます。この基礎的な設計は転送と再送を識別する必要を取り除くための判断でありTCP損失検知機構のQUICの解釈から致命的な複雑さを排します。

それぞれのパケットはいくつかのフレームを含むでしょう。我々は損失検知と輻輳制御の機構のために重要なフレームを以下に位置付けます。

- 再送可能なフレームは信頼できる配送を要求するフレームです。もっとも一般的なものはアプリケーションデータを含む典型的なSTREAMフレームです。
- 暗号ハンドシェイクデータはstream 0上で送られ、QUICの裏で信頼できる機構を使用します
- ACKフレームは応答情報を含みます。QUICはackが256長を上限として表現するSACKに基づく枠組みを使用します。またACKフレームは最新の応答したそれぞれのパケットのためのタイムスタンプの受信も含みます。

## 2.1. QUICとTCPの間の差分関連

TCPの損失検知と輻輳制御に詳しい読者は、
よく知られた並列TCPのひとつとしてアルゴリズムを認めるでしょう。QUICとTCPの間のプロトコルの違いであっても手続きの違いを与えます//TODO: 翻訳がこなれてない

## 2.1.1. パケットナンバーの単一的な増加

// TODO:  and any data that is to...を再考する
TCPは送信者における転送シークエンスナンバーと、同じシークエンスナンバーを運ぶ同じアプリケーションデータの結果を返す受信者における配送シークエンスナンバーを
まとめて扱います。
// TODO: 同じ～を再検討
ゆえに、"再送曖昧性"による問題が起こります。QUICはこれを二つに分けます。QUICはパケットシークエンスナンバー(パケットナンバーとして参照)を転送のために使用し、任意のデータは配送のために、配送順が決定するパケットのSTREAMフレームの中に変換され、ストリームオフセットと共に一つ以上のストリームとしてアプリケーションが受け取ります。

QUICのパケットナンバーは単純に増加し、また直接転送順に変換されます。より高位のQUICパケットナンバーはそのパケットがより後に送られたことを示し、下位のQUICパケットナンバーはパケットがより早く送られたことを示します。フレームを含むパケットが損失したと思われたと、QUICは必要なフレームを新しいパケットナンバーの新しいフレームとして構築し、ACKを受け取った時にどのパケットが応答したかの曖昧性を取り除きます。結果として、よりよいRTT圧縮がなされます。偽造の再送は容易く検知され、ファストリトランスミッションのような機構はパケットナンバーに基づくだけで、汎用的に適応できます。

この設計はQUICに対して明確な損失検知機構の簡略化を示します。多くのTCP機構のは暗黙的に転送がTCPシークエンスナンバーによる順序づけられることを仮定します。これは些細な作業ではなく、特にTCPタイムスタンプがない時に顕著です。

## 2.1.2 無破棄

QUIC ACKはTCP SACKと同等の情報を保持します。しかし、QUICは任意のACKパケットが破棄されることを許可しません。
// TODO: both sides andは文法的におかしい。落丁を感じる


## 2.1.3 より良いACK幅

QUICはTCPの3SACKに対して、256ACKを上限として提供します。高損失環境においてこれは回復を向上します。

## 2.1.4 遅延ACKに対する明示的な訂正

QUIC ACKはパケットを受け取った時と対応するACKが送られた時の間の、受信者が被る遅延を変換します。これはACKの受信者が経路RTTを見積もる時に受信者の遅延、特に遅延ACKタイマによって調整することを許します。この機構はOS kernelによって、パケットが受信された時からの遅延を計測し報告することを許可します。これは受信者において、ユーザ空間QUIC受信者が受け取ったパケットを処理する前にコンテクストスイッチのような遅延を被ることに有用です。
//TODO: 最後の一文推敲

# 3. 損失検知

## 3.1.概略

QUICはACK情報とパケット損失の検知アラームび結合を用います応答していないQUICパケットは以下のどれかの方法の一つによって損失として認められます。

- 応答の後にパケット数の閾値(kReorderingThreshold)が送られたら、パケットが損失したとします。
- もしパケットが最後に近く、kReorderingThreshold より少ないパケットがその後に送られるなら、送信者は前述の機構により損失を検知することを期待できません。この場合、送信者はACK情報と損失検知アラームの両方を使用します。特に、最後に送ったパケットが応答したとき、送信者は再順序づけ任意の応答されないパケットを損失したと認めるため、短期間待ちます。この機構はTCP Early Retransmit のlinux実装を基にしています。
- もし、パケットが最後に近く送られ、その後に送るパケットがなく、送信者がその損失の検知にACK情報を用いることができないなら、送信者はそれ故に終端の損失を検知するためにアラームに依存します。この機構はTCPのTail Loss ProbのLinux実装を基にしています。
- もし他のすべてが失敗したならRetransmission Timeout (RTO)アラームは任意の再送可能なパケットが未決定である時、常にセットされる。このアラームが発生した時、すべての応答していないパケットは損失したとみなす。
// TODO: 怪しい翻訳
- 再整列に耐えうるためパケット閾値の代わりにQUIC送信者はタイム閾値を用いても良い。これはそうが明瞭な再整列の短期の耐性を持つことを許容する。この機構において、QUIC送信者はより大きなパケットナンバーが応答し、パケットを送信してから閾値を超える時間が経過したとき、パケットを損失したとみなす。
- stream 0のためのSTREAMフレームを含むハンドシェイクパケットはQUIC transportと暗号ネゴシエーションにとって重要であるため、これらには分割したアラーム期間を用いる。
//TODO: separate alerm period

# 3.2 アルゴリズム概要

## 3.2.1.  Constants of interest

損失検知に用いられるConstantsはRFCs、論文そして実践一般の集約に基づきます。いくらは様々な環境に適応するために変更や交渉することが必要かもしれません。 

## 3.2.2. 変数

## 3.2.3. 初期化

# 4. 服装制御

# 4.1.スロースタート

# 4.2. 輻輳回避

# 4.3. 回復期間

# 4.4. Tail Loss Prob

# 4.5. 再送タイムアウト

# 4.6. pacing rate

# 4.7. 疑似コード

## 4.7.1. 定数

## 4.7.2. 変数

## 4.7.3 初期化

## 4.7.4 パケット送信時

## 4.7.5 パケット応答時

## 4.7.6 パケッ損失時

## 4.7.7. 再送タイムアウト有効時
 
